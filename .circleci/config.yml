version: 2
jobs:
  build:
    docker: 
      -image: circleci/node:10
    filters:
      branches:
        only: master
    steps:
      - checkout
      - restore_cache:
        keys:
          # Find a cache corresponding to this specific package-lock.json
          - v1-npm-deps-{{ checksum "package-lock.json" }}
          # Fallback cache to be used
          - v1-npm-deps-      
      - run:
        name: Install dependencies
        command: npm install
      - save_cache:
        key: v1-npm-deps-{{ checksum "package-lock.json" }}
        paths:
          - ./node_modules     
      - run:
        name: Gatsby Deploy
        command: npm run deploy   
